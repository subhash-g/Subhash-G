<!--<div id="top-bar">
	<div class="logo">
		<img src="/images/boomtrain.png" />
	</div>
</div>-->
<div id="banner">
	<p id="banner_message"></p>
</div>

<div id="title-bar">
	<div class="logo">
		<img src="<%= logo %>" />
	</div>
</div>

<div id="body">
	<div id="left-menu">
		<div class="menu-items">
			<div class="menu-item">
				<!-- Localise Left Nav links (list page/prefs page) - based on account property -->
				<% if (langPref == 'ES'){ %>
				<img src="/images/profile-off.png" id="list-icon"/><a id="btn-my-list" href="javascript:void(0);">Mis Boletines</a>
				<% } else if (langPref == 'BP'){ %>
				<img src="/images/profile-off.png" id="list-icon"/><a id="btn-my-list" href="javascript:void(0);">Minhas Newsletters - VEJA</a>
				<% } else { %>
				<img src="/images/profile-off.png" id="list-icon"/><a id="btn-my-list" href="javascript:void(0);">My Lists</a>
				<% } %>
			</div>
			<div class="menu-item">
				<% if (langPref == 'ES'){ %>
				<img src="/images/list-on.png" id="profile-icon"/><a id="btn-my-profile" href="javascript:void(0);">Mi Perfil</a>
				<% } else if (langPref == 'BP'){ %>
				<img src="/images/list-on.png" id="profile-icon"/><a id="btn-my-profile" href="javascript:void(0);">Meu Perfil</a>
				<% } else { %>
				<img src="/images/list-on.png" id="profile-icon"/><a id="btn-my-profile" href="javascript:void(0);">My Profile</a>
				<% } %>
			</div>
		</div>
	</div>

	<div id="content">
		<div id="profile-form" class="form">
			<div class="fieldset-container">


<% if (name == 'Advisor Perspectives') { %>
	<% profile.forEach(function(prop, index) { %>

		<% if (prop.name == 'Role in Company') { %>

			<fieldset>
				<label><%= prop.name %></label>
				<select class="drop-down">

  				<% if (prop.value) { %>

        	<option type="dropdown" class="profile-input" value="<%= prop.value %>" data-property="<%= prop.property %>"> <%= prop.value %></option>

      		<% } else { %>

        	<option type="dropdown" class="profile-input" value="" data-property="<%= prop.value %>"><%= prop.name %></option>

      		<% } %>

				  <option type="dropdown" class="profile-input" value="Independent Financial Planner/Advisor" data-property="<%= prop.property %>">Independent Financial Planner/Advisor</option>
				  <option type="dropdown" class="profile-input" value="Registered Investment Advisor (RIA)" data-property="<%= prop.property %>">Registered Investment Advisor (RIA)</option>
				  <option type="dropdown" class="profile-input" value="Registered Representative - Wirehouse" data-property="<%= prop.property %>">Registered Representative - Wirehouse</option>
				  <option type="dropdown" class="profile-input" value="Registered Representative - IBD" data-property="<%= prop.property %>">Registered Representative - IBD</option>
				  <option type="dropdown" class="profile-input" value="Insurance" data-property="<%= prop.property %>">Insurance</option>
				  <option type="dropdown" class="profile-input" value="Accounting" data-property="<%= prop.property %>">Accounting</option>
				  <option type="dropdown" class="profile-input" value="Bank Advisor" data-property="<%= prop.property %>">Bank Advisor</option>
				  <option type="dropdown" class="profile-input" value="Other" data-property="<%= prop.property %>">Other</option>
				</select>
			</fieldset>

		<% } else if (prop.name == 'AUM') { %>

			<fieldset>
				<label><%= prop.name %></label>
				<select class="drop-down">

  				<% if (prop.value) { %>

        	<option type="dropdown" class="profile-update" value="<%= prop.value %>" data-property="<%= prop.property %>"> <%= prop.value %></option>

      		<% } else { %>

        	<option type="dropdown" class="profile-update" value="" data-property="<%= prop.value %>"><%= prop.name %></option>

      		<% } %>

				  <option type="dropdown" class="profile-update" value="I don't manage assets" data-property="<%= prop.property %>">I don't manage assets</option>
				  <option type="dropdown" class="profile-update" value="Less than $500,000" data-property="<%= prop.property %>">Less than $500,000</option>
				  <option type="dropdown" class="profile-update" value="$500,000-$1 million" data-property="<%= prop.property %>">$500,000-$1 million</option>
				  <option type="dropdown" class="profile-update" value="$1 million-$10 million" data-property="<%= prop.property %>">$1 million-$10 million</option>
				  <option type="dropdown" class="profile-update" value="$10 million-$50 million" data-property="<%= prop.property %>">$10 million-$50 million</option>
				  <option type="dropdown" class="profile-update" value="$50 million-$100 million" data-property="<%= prop.property %>">$50 million-$100 million</option>
				  <option type="dropdown" class="profile-update" value="$100 million-$500 million" data-property="<%= prop.property %>">$100 million-$500 million</option>
				  <option type="dropdown" class="profile-update" value="$500 million-$1 billion" data-property="<%= prop.property %>">$500 million-$1 billion</option>
				  <option type="dropdown" class="profile-update" value="Over $1 billion" data-property="<%= prop.property %>">Over $1 billion</option>
				</select>
			</fieldset>

		<% } else { %>
			<% if (prop.name == 'Email') { %>
				<fieldset id="full-width">
					<label><%= prop.name %></label>
					<input type="text" class="profile-input" data-property="<%= prop.property %>" value="<%= prop.value %>">
				</fieldset>
			<% } else { %>
				<fieldset>
					<label><%= prop.name %></label>
					<input type="text" class="profile-input" data-property="<%= prop.property %>" value="<%= prop.value %>">
				</fieldset>
			<% } %>

		<% } %>

	<% }); %>

<% } else { %>

	<% profile.forEach(function(prop, index) { %>
		<fieldset>
			<label><%= prop.name %></label>
			<input type="text" class="profile-input" data-property="<%= prop.property %>" value="<%= prop.value %>">
		</fieldset>
	<% }); %>

<% } %>


			</div>
			<div>
				<!-- Localise Save Profile - based on account property -->
				<% if (langPref == 'ES'){ %>
				<input id="btn-save-profile" class="btn btn-save" type="submit" value="Guardar mis Preferencias">
				<% } else if (langPref == 'BP'){ %>
				<input id="btn-save-profile" class="btn btn-save" type="submit" value="Salvar">
				<% } else { %>
				<input id="btn-save-profile" class="btn btn-save" type="submit" value="Save Profile">
				<% } %>
			</div>
		</div>
		<div id="list-form" class="form">
			<div class="fieldset-container">
<!-- SET EMAIL IN HEADER FOR ONLY IMPREMEDIA ONLY (this was Honest Reporting section) -->
                <% if (name.indexOf('Impremdia') == -1) { %> <!-- DO FOR OTHERS -->
    				<% if(header) { %>
    					<div class="header"><%= header %></div>
    				<% } %>

                <% } else { %>


        			<% if (name.indexOf('Impremdia') != -1) { %> <!-- DO FOR IMPREMEDIA ONLY - add div for user prefs -->
                        <% if(header) { %>
                            <div class="header" style="text-align:left !important"><%= header %></div>
                        <% } %>

                        <!-- START: add a div to contain NON EDITABLE user prefs -->
        				<% counter = 0 %>
        				<% profile.forEach(function(prop, index) { %>
    						<% if(counter == 0) { %>
        						<div class="header" style="text-align:left !important">
        						<p>Su correo electrónico:&nbsp;<b><%= prop.value %> </b></p>


        						</div>
    						<% } %>
    					<% counter++ %>
                        <% }); %>
    	        <!-- END: add a div to contain user prefs -->
            		<% } %>

                <% } %>     <!-- END IF -->
<!-- END CUSTOM HEADER FOR ONLY IMPREMEDIA ONLY -->

<!-- SET LAYOUT FOR ONLY IMPREMEDIA -->
				<% if (name.indexOf('Impremdia') != -1){ %>
					<% counter = 1 %>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 0) { %>
							<% if (list.listType !='dropDown'){ %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type ? list.type : '' %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />
								<% } %>
								<% if ( list.listType == 'dropDown') { %>

								<select class="drop-down" checked>
									<% if(list.value) { %>
									<option type="dropdown" class="list-input" value="<%= list.value %>" data-property="<%= list.property %>"> <%= list.value %></option>
									<% } else { %>
									<option type="dropdown" class="list-input" value="" data-property="<%= list.value %>">Seleccionar signo</option>
									<% } %>
									<!--<option type="dropdown" class="list-input"
									value="<%= list.value %>" data-property="<%= list.value %>"> <%= list.value %>
									-->
									</option>
									<option type="dropdown" class="list-input"
									value="Aries" data-property="<%= list.property %>">Aries
									</option>
									<option type="dropdown" class="list-input"
									value="Tauro" data-property="<%= list.property %>">Tauro
									</option>
									<option type="dropdown" class="list-input"
									value="Geminis" data-property="<%= list.property %>">Géminis
									</option>
									<option type="dropdown" class="list-input"
									value="Cancer" data-property="<%= list.property %>">Cáncer
									</option>
									<option type="dropdown" class="list-input"
									value="Leo" data-property="<%= list.property %>">Leo
									</option>
									<option type="dropdown" class="list-input"
									value="Virgo" data-property="<%= list.property %>">Virgo
									</option>
									<option type="dropdown" class="list-input"
									value="Libra" data-property="<%= list.property %>">Libra
									</option>
									<option type="dropdown" class="list-input"
									value="Escorpio" data-property="<%= list.property %>">Escorpio
									</option>
									<option type="dropdown" class="list-input"
									value="Sagitario" data-property="<%= list.property %>">Sagitario
									</option>
									<option type="dropdown" class="list-input"
									value="Capricornio" data-property="<%= list.property %>">Capricornio
									</option>
									<option type="dropdown" class="list-input"
									value="Acuario" data-property="<%= list.property %>">Acuario
									</option>
									<option type="dropdown" class="list-input"
									value="Piscis" data-property="<%= list.property %>">Piscis
									</option>
								</select>
								<% } %>
								<% if(list.description) { %>
									<div class="description"><%= list.description %></div>
									<% counter++ %>

								<% } %>
							<% } %>
						<% }); %>
					</fieldset>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 1) { %>
							<% if (list.listType !='dropDown'){ %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />
								<% } %>
								<% if ( list.listType == 'dropDown') { %>
								<select class="drop-down" checked>
									<% if(list.value) { %>
									<option type="dropdown" class="list-input" value="<%= list.value %>" data-property="<%= list.property %>"> <%= list.value %></option>
									<% } else { %>
									<option type="dropdown" class="list-input" value="" data-property="<%= list.property %>">Seleccionar signo</option>
									<% } %>
									<!--<option type="dropdown" class="list-input"
									value="<%= list.value %>" data-property="<%= list.value %>"> <%= list.value %>
									</option>-->
									<option type="dropdown" class="list-input"
									value="Aries" data-property="<%= list.property %>">Aries
									</option>
									<option type="dropdown" class="list-input"
									value="Tauro" data-property="<%= list.property %>">Tauro
									</option>
									<option type="dropdown" class="list-input"
									value="Geminis" data-property="<%= list.property %>">Géminis
									</option>
									<option type="dropdown" class="list-input"
									value="Cancer" data-property="<%= list.property %>">Cáncer
									</option>
									<option type="dropdown" class="list-input"
									value="Leo" data-property="<%= list.property %>">Leo
									</option>
									<option type="dropdown" class="list-input"
									value="Virgo" data-property="<%= list.property %>">Virgo
									</option>
									<option type="dropdown" class="list-input"
									value="Libra" data-property="<%= list.property %>">Libra
									</option>
									<option type="dropdown" class="list-input"
									value="Escorpio" data-property="<%= list.property %>">Escorpio
									</option>
									<option type="dropdown" class="list-input"
									value="Sagitario" data-property="<%= list.property %>">Sagitario
									</option>
									<option type="dropdown" class="list-input"
									value="Capricornio" data-property="<%= list.property %>">Capricornio
									</option>
									<option type="dropdown" class="list-input"
									value="Acuario" data-property="<%= list.property %>">Acuario
									</option>
									<option type="dropdown" class="list-input"
									value="Piscis" data-property="<%= list.property %>">Piscis
									</option>
								</select>
								<% } %>

								<% if(list.description) { %>
									<div class="description"><%= list.description %></div>

								<% counter++ %>
								<% } %>
							<% } %>
						<% }); %>
					</fieldset>
					</fieldset>
<!-- END LAYOUT FOR ONLY IMPREMEDIA -->


<!-- SET LAYOUT FOR ONLY WNYT -->
				<% } else if ( name == 'WNYT'){ %>
					<% counter = 1 %>

					<fieldset class="dropdown">  <!-- WNYT SECTION 1: DROPDOWN FOR FIRST 4 USER PROPS -->
						<select id="WNYT">
							<% lists.forEach(function(list, index) { %>
							<% if(counter<= 4) { %>
								<% if(list.value ==  list.name) { %>
									<option type="dropdown" class="list-input" value="<%= list.name %>" data-property="<%= list.property %>" selected> <%= list.name %></option>
								<% } else { %>
									<option type="dropdown" class="list-input" value="<%= list.name %>" data-property="<%= list.property %>"> <%= list.name %></option>
								<% } %>
								<% counter++ %>

							<% } else if(counter==5){%>	 <!-- WNYT SECTION 2: CHECKBOXES FOR OTHER USER PROPS -->

								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />
								<% if(list.description) { %>
									<div class="description" style="text-align:left !important;"><%= list.description %></div>

								<% } %>
								<div>&nbsp;</div>

							<% } %>
							<% }); %>
						</select>
					</fieldset>
<!-- END LAYOUT FOR ONLY WNYT -->


<!-- SET LAYOUT FOR ONLY KOB -->
				<% } else if ( name == 'KOB'){ %>
					<% counter = 1 %>

					<fieldset class="dropdown">  <!-- KOB SECTION 1: DROPDOWN FOR FIRST 4 USER PROPS -->
						<select id="KOB">
							<% lists.forEach(function(list, index) { %>
							<% if(counter<= 4) { %>
								<% if(list.value ==  list.name) { %>
									<option type="dropdown" class="list-input" value="<%= list.name %>" data-property="<%= list.property %>" selected> <%= list.name %></option>
								<% } else { %>
									<option type="dropdown" class="list-input" value="<%= list.name %>" data-property="<%= list.property %>"> <%= list.name %></option>
								<% } %>
								<% counter++ %>

							<% } else if(counter==5){%>	 <!-- KOB SECTION 2: CHECKBOXES FOR OTHER USER PROPS -->

								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />
								<% if(list.description) { %>
									<div class="description" style="text-align:left !important;"><%= list.description %></div>

								<% } %>
								<div>&nbsp;</div>

							<% } %>
							<% }); %>
						</select>
					</fieldset>
<!-- END LAYOUT FOR ONLY KOB -->


<!-- SET LAYOUT FOR ONLY DIGINOMICA -->
				<% } else if ( name == 'Diginomica')  { %>

					<fieldset class="dropdown"> <!-- ALL DIGINOMICA USER PROPS PRESENTED AS DROPDOWN -->
						<select id="Diginomica">
							<% lists.forEach(function(list, index) { %>
								<% if(list.value ==  list.name) { %>
									<option type="dropdown" class="list-input" value="<%= list.name %>" data-property="<%= list.property %>" selected> <%= list.name %></option>
								<% } else { %>
									<option type="dropdown" class="list-input" value="<%= list.name %>" data-property="<%= list.property %>"> <%= list.name %></option>
								<% } %>
							<% }); %>
						</select>
					</fieldset>
<!-- END LAYOUT FOR ONLY DIGINOMICA -->

<!-- SET LAYOUT FOR ONLY SHEFINDS -->
				<% } else if ( name == 'SheFinds')  { %>
					<% counter = 1 %>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
								<input type="radio" id="radioG<%= counter %>" class="list-input" data-property="<%= list.property %>" data-property-value="<%= list.name %>" data-property-type="<%= list.type %>" name="frequency" value="<%= list.property %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> > <%= list.name %>
							<% counter++ %>
						<% }); %>
					</fieldset>
<!-- END LAYOUT FOR ONLY SHEFINDS -->

<!-- SET LAYOUT FOR ONLY GAMESPOT -->
				<% } else if ( name == 'GameSpot')  { %>
					<style>
					body{background:#ffffff;}
					#btn-save-list{background:#e02b00 !important;}
					#btn-unsub-all{color:#858585 !important;}
					#btn-my-profile,#btn-my-list{color:#e02b00 !important;}
					</style>
					<% counter = 1 %>

					<fieldset>
						<% lists.forEach(function(list, index) { %>

							<% if((index % 2 == 0) && (list.property !== 'properties.opt_in')) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type ? list.type : '' %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

								<% counter++ %>

							<% } else if((index % 2 == 0) && (list.property == 'properties.opt_in')) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type ? list.type : '' %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : 'checked' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>

					<fieldset>
						<% lists.forEach(function(list, index) { %>

							<% if((index % 2 == 1) && (list.property !== 'properties.opt_in')) { %>
								<% if ( list.listType !== 'dropDown') { %>
									<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
									<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

									<% counter++ %>
								<% } %>
								<% if ( list.listType == 'dropDown') { %>
									<select class="drop-down" checked>
										<% if(list.value) { %>
											<option type="dropdown" class="list-input" value="<%= list.value %>" data-property="<%= list.property %>"> <%= list.name %>: <%= list.value %></option>
										<% } else { %>
											<option type="dropdown" class="list-input" value="" data-property="<%= list.value %>">Please select a cadence</option>
										<% } %>

										<option type="dropdown" class="list-input"
										value="1x_weekly" data-property="<%= list.property %>">1x Weekly
										</option>
										<option type="dropdown" class="list-input"
										value="2x_weekly" data-property="<%= list.property %>">2x Weekly
										</option>
										<option type="dropdown" class="list-input"
										value="3x_weekly" data-property="<%= list.property %>">3x Weekly
										</option>
										<option type="dropdown" class="list-input"
										value="4x_weekly" data-property="<%= list.property %>">4x + Weekly
										</option>
									</select>
								<% } %>
							<% } %>

						<% }); %>
					</fieldset>

<!-- END LAYOUT FOR ONLY GAMESPOT -->

<!-- SET LAYOUT FOR ADVISOR PERSPECTIVES -->
				<% } else if ( name == 'Advisor Perspectives')  { %>
					<style>
					body{background:#ffffff;}
					</style>

					<% counter = 1 %>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 0) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type ? list.type : '' %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

								<% if(counter == 1) { %>
									<% if(list.description) { %>
										<div class="description">Flagship newsletter with original articles<br><i>Tuesday at 6a ET</i></div>
									<% } %>
								<% } %>

								<% if(counter == 2) { %>
									<% if(list.description) { %>
										<div class="description">An aggregation of today’s top market commentaries by industry thought leaders<br><i>Daily at 4p ET</i></div>
									<% } %>
								<% } %>

								<% if(counter == 3) { %>
									<% if(list.description) { %>
										<div class="description">Charts of market and economics trends by Jill Mislinski<br><i>Tues-Sat at 9a ET</i></div>
									<% } %>
								<% } %>

								<% if(counter == 4) { %>
									<% if(list.description) { %>
										<div class="description">Occasional messages from our partners<br><i>Occasional</i></div>
									<% } %>
								<% } %>

								<% if(counter == 5) { %>
									<% if(list.description) { %>
										<div class="description">Our most-read articles in the previous month<br><i>Once per month</i></div>
									<% } %>
								<% } %>

								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 1) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

								<% if(counter == 6) { %>
									<% if(list.description) { %>
										<div class="description">Original content focused on managing your practice<br><i>Thursday at 6a ET</i></div>
									<% } %>
								<% } %>

								<% if(counter == 7) { %>
									<% if(list.description) { %>
										<div class="description">Thought provoking original content sent early in the mornings for your commute<br><i>M, W, F at 4a or 6a ET</i></div>
									<% } %>
								<% } %>
								<% if(counter == 8) { %>
									<% if(list.description) { %>
										<div class="description">Custom webinars often with CE credits for CFP, IMCA and other CE opportunities<br><i>Occasional</i></div>
									<% } %>
								<% } %>
								<% if(counter == 9) { %>
									<% if(list.description) { %>
										<div class="description">Spotlight of the top white papers this month<br><i>Once per month</i></div>
									<% } %>
								<% } %>
								<% if(counter == 10) { %>
									<% if(list.description) { %>
										<div class="description">Our most-read commentaries that week<br><i>Delivered Friday afternoons</i></div>
									<% } %>
								<% } %>

								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>
<!-- END LAYOUT FOR ADVISOR PERSPECTIVES -->

<!-- SET LAYOUT FOR ONLY PARIS REVIEW -->
				<% } else if ( name == 'theParisReview')  { %>
					<% counter = 1 %>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 0) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type ? list.type : '' %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

								<% if(counter == 1) { %>
									<% if(list.description) { %>
										<div class="description">The best of <i>The Paris Review Daily</i>, once a week.</div>
									<% } %>
								<% } %>
								<% if(counter == 2) { %>
									<% if(list.description) { %>
										<div class="description">Monthly updates, issues releases, events, and more from <i>The Paris Review</i>.</div>
									<% } %>
								<% } %>
								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 1) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

								<% if(counter == 3) { %>
									<% if(list.description) { %>
										<div class="description">See which interviews, stories, and poems the editors unlocked this week.</div>
									<% } %>
								<% } %>

								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>
<!-- END LAYOUT FOR ONLY PARIS REVIEW -->


<!-- SET LAYOUT FOR ONLY THE GAZETTE -->
				<% } else if ( name == 'The Gazette')  { %>
				<% counter = 1 %>
				<fieldset>
				  <% lists.forEach(function(list, index) { %>
				    <% if(index <= 5) { %>
				      <input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type ? list.type : '' %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
				      <label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

				      <% if(list.description) { %>
				        <div class="description"><%= list.description %></div>
				      <% } %>
				      <% counter++ %>
				    <% } %>
				  <% }); %>
				</fieldset>
				<fieldset>
				  <% lists.forEach(function(list, index) { %>
				    <% if(index > 5) { %>
				      <input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
				      <label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />
				      <% if(list.description) { %>
				        <div class="description"><%= list.description %></div>
				      <% } %>
				      <% counter++ %>
				    <% } %>
				  <% }); %>
				</fieldset>
<!-- END LAYOUT FOR ONLY THE GAZETTE -->

<!-- SET LAYOUT FOR IDG -->
				<% } else if ( name == 'CIO-UK' || name == 'Computerworld UK' || name == 'Techworld.com UK')  { %>
					<% counter = 1 %>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 0) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type ? list.type : '' %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : 'checked' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

								<% if(list.description) { %>
									<div class="description"><%= list.description %></div>
								<% } %>
								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 1) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : 'checked' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />
								<% if(list.description) { %>
									<div class="description"><%= list.description %></div>
								<% } %>
								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>
<!-- END LAYOUT FOR IDG -->

<!-- SET LAYOUT FOR EVERYONE ELSE -->
				<% } else { %>
					<% counter = 1 %>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 0) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type ? list.type : '' %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />

								<% if(list.description) { %>
									<div class="description"><%= list.description %></div>
								<% } %>
								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>
					<fieldset>
						<% lists.forEach(function(list, index) { %>
							<% if(index % 2 == 1) { %>
								<input type="checkbox" id="checkboxG<%= counter %>" class="css-checkbox list-input" data-property="<%= list.property %>" data-property-value="<%= list.type == 'array' ? list.name : '' %>" data-property-type="<%= list.type %>" <%= list.value.toLowerCase() == 'true' ? 'checked' : '' %> />
								<label for="checkboxG<%= counter%>" class="css-label radGroup1" checked><%= list.name %></label><br />
								<% if(list.description) { %>
									<div class="description"><%= list.description %></div>
								<% } %>
								<% counter++ %>
							<% } %>
						<% }); %>
					</fieldset>
				<% } %>
<!-- END LAYOUT FOR EVERYONE ELSE -->

			</div>

			<div>
				<!-- Localise Save Profile  - based on account property -->
				<% if (langPref == 'ES'){ %>
				<input id="btn-save-list" class="btn btn-save" type="submit" value="Guardar mis Preferencias">
				<% } else if (langPref == 'BP'){ %>
				<input id="btn-save-list" class="btn btn-save" type="submit" value="Salvar">
				<% } else { %>
				<input id="btn-save-list" class="btn btn-save" type="submit" value="Save Profile">
				<% } %>
			</div>
			<div class="unsub">
				<!-- Localise Unsub from all  - based on account property -->
				<% if (langPref == 'ES'){ %>
				<a id="btn-unsub-all">Bajar de todos los boletines</a>
				<% } else if (langPref == 'BP'){ %>
				<a id="btn-unsub-all">Cancelar Todas</a>
				<% } else { %>
				<a id="btn-unsub-all">Unsubscribe from All</a>
				<% } %>

			</div>
			<div class="message_uid"></div>
			<div id="powered_by"><span>Powered by</span><br />
				<div class="logo"><a href="http://boomtrain.com" target="_blank"><img src="/images/boomtrain-white.png" /></a></div>
			</div>
		</div>
	</div>
</div>

<script>
var selectMyProfile = function() {
	$("#list-form").hide();
	$("#btn-my-list").removeClass("selected");
	$("#profile-icon").attr("src","/images/profile-on.png");
	$("#list-icon").attr("src","/images/list-off.png");
	$("#profile-form").show();
	$("#btn-my-profile").addClass("selected");
}

var selectMyList = function() {
	$("#profile-form").hide();
	$("#btn-my-profile").removeClass("selected");
	$("#profile-icon").attr("src","/images/profile-off.png");
	$("#list-icon").attr("src","/images/list-on.png");
	$("#list-form").show();
	$("#btn-my-list").addClass("selected");
}

var updatePreferences = function() {
	var preferences = {};

	var selected = false;
	$(".profile-update").toArray().forEach(function(item) {
		var key = $(item).attr("data-property");
		var type = $(item).attr("type");

		if (type == "dropdown") {
			// console.log(key + " item selected " + item.selected);
			if (!selected && item.selected) {
				preferences[key] = $(item).val();
				selected = true;
			}
		} else {
			preferences[key] = $(item).val();
		}
	});

	var selected = false;
	$(".profile-input").toArray().forEach(function(item) {
		var key = $(item).attr("data-property");
		var type = $(item).attr("type");

		if (type == "dropdown") {
			// console.log(key + " item selected " + item.selected);
			if (!selected && item.selected) {
				preferences[key] = $(item).val();
				selected = true;
			}
		} else {
			preferences[key] = $(item).val();
		}
	});

	$(".list-input").toArray().forEach(function(item) {
		var key = $(item).attr("data-property");
		var dataVal = $(item).attr("data-property-value");
		var dataType = $(item).attr("data-property-type");
		var type = $(item).attr("type");

		if (type != "dropdown") {
			if (dataType == 'array') {
				if (key in preferences) {
					if (item.checked) {
						preferences[key].push(dataVal);
					}
				} else {
					if (item.checked) {
						preferences[key] = [dataVal];
					} else {
						preferences[key] = [];
					}
				}
			} else {
				preferences[key] = item.checked ? "true": "false";
			}
		} else {
			//console.log(key + " item selected " + item.selected);
			if (!selected && item.selected) {
				preferences[key] = $(item).val();
				selected = true;
			}
		}
	});

	if (getParameterByName("message_uid")) {
		var url = "/preferences/<%= customerId %>/users/<%= userId %>?message_uid=" + getParameterByName("message_uid");
	} else {
		var url = "/preferences/<%= customerId %>/users/<%= userId %>";
	}

	$.ajax({
		url: url,
		method: 'POST',
		data: JSON.stringify(preferences),
		beforeSend: function(xhr, settings) {
			xhr.setRequestHeader("Content-Type", "application/json");
			xhr.setRequestHeader("Accept", "application/json");
		},
		success: function(data, status, xhr) {
			alert("Preferences successfully updated.");
		},
		error: function(xhr, status, error) {
			alert("An error occurred updating your preferences(" + error.message + ").  Please try again.");
		}
	});

	//split 'customerId' value at _ separator and use the first section only
	mixpanel.track("preferences-updated", {'customerId': <%= customerId.split("_", 1) %> });

	return false;
};

function getParameterByName(name, url) {
		if (!url) url = window.location.href;
		name = name.replace(/[\[\]]/g, "\\$&");
		var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
				results = regex.exec(url);
		if (!results) return null;
		if (!results[2]) return '';
		return decodeURIComponent(results[2].replace(/\+/g, " "));
}

var unsubscribeAll = function() {
	var url = "/preferences/<%= customerId %>/users/<%= originalUserId %>/unsubscribeAll";

	$.ajax({
		url: url,
		method: 'POST',
		data: "",
		beforeSend: function(xhr, settings) {
			xhr.setRequestHeader("Content-Type", "application/json");
			xhr.setRequestHeader("Accept", "application/json");
		},
		success: function(data, status, xhr) {
			alert("Unsubscribe all successfully updated.");
		},
		error: function(xhr, status, error) {
			alert("An error occurred updating your preferences(" + error.message + ").  Please try again.");
		}
	});

	//split 'customerId' value at _ separator and use the first section only
	mixpanel.track("preferences-updated", {'customerId': <%= customerId.split("_", 1) %> });
}

$("#btn-my-profile").click(selectMyProfile);
$("#btn-my-list").click(selectMyList);
$("#btn-save-profile").click(updatePreferences);
$("#btn-save-list").click(updatePreferences);

//$("#btn-unsub-all").click(unsubscribeAll);

// saves message_uid
if (getParameterByName("message_uid")) {
	$(".message_uid").attr("id", getParameterByName("message_uid"));
	$("#btn-unsub-all").attr("href", "/preferences/<%= customerId %>/users/<%= originalUserId %>/unsubscribeAll?message_uid=" + getParameterByName("message_uid"));
} else {
	$("#btn-unsub-all").attr("href", "/preferences/<%= customerId %>/users/<%= originalUserId %>/unsubscribeAll");
}

var message = '<%- req.flash('message') %>';
if (message != '') {
	alert(message);
}


var page = getParameterByName('page');
if(page && page != '') {
	if(page == "1") {
		selectMyList();
	}
	else if(page == "2") {
		selectMyProfile();
	}
	else {
		selectMyList();
	}
}
else {
	selectMyList();
}
status = ('<%= unsubStatus %>');
list = ('<%= unsubListName %>');
var listsObj = []
<% lists.forEach(function(list, index){ %>
	listsObj[<%= index %>] = {}
	listsObj[<%= index %>].name = ('<%= list.name %>');
	listsObj[<%= index %>].property = ('<%= list.property %>');
<% }); %>
var bannerSlide = function(unsubList, status){
	var name = ''
	for(var a = 0; a < listsObj.length; a++){
		if(listsObj[a].property === "properties."+unsubList){
			name = listsObj[a].name
		}
	}
	if(status === 'true'){
		$("#banner").css('background-color','#3DC054')
		$("#banner_message").text('You have been successfully unsubscribed from ' + name )
	} else {
		$("#banner").css('background-color','#FE314A')
		$("#banner_message").text('Unable to unsubscribe.')
	}
	$("#banner").slideDown().delay(3000).slideUp();
}
$("#banner").hide();
if(list != 'undefined')
	bannerSlide(list,status)

name = ('<%= name %>');


$("fieldset.dropdown").css({
	"padding-top": "30px !important",
		"text-align": "center !important"
});

$("select").css({
		"color": "#536266",
		"margin": "50px",
		"border": "1px solid rgba(33, 39, 54, .2)",
		"background": "transparent",
		"width": "200px",
		"padding": "20px",
		"font-size": "16px",
		"height": "50px",
		"font-family": "'Lato', sans-serif"
});

</script>

<script>
	//split 'customerId' value at _ separator and use the first section only
	mixpanel.track("page-load", {'customerId': <%= customerId.split("_", 1) %> });
</script>

<script type="text/javascript" src="/js/jspatch.js"></script>
